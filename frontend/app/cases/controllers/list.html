<div class="widget-container">
    <div class="widget-heading hl-card-heading">
        <div class="widget-title">
            <ul class="hl-button-group">
                <li class="hl-button-group-btn">
                    <a class="hl-button-group-btn-link" href="javascript:;" data-toggle="dropdown">
                        <i class="fa fa-columns"></i>
                        <span class="hide-on-tablet">Columns</span>
                        <i class="margin-left-5 small-icon lilicon hl-toggle-down-icon"></i>
                    </a>

                    <ul class="hl-dropdown js-hold-on-click">
                        <li class="hl-dropdown-item"><checkbox model="vm.table.visibility.caseId">No.</checkbox></li>
                        <li class="hl-dropdown-item"><checkbox model="vm.table.visibility.subject">Subject</checkbox></li>
                        <li class="hl-dropdown-item"><checkbox model="vm.table.visibility.client">Client</checkbox></li>
                        <li class="hl-dropdown-item"><checkbox model="vm.table.visibility.type">Type</checkbox></li>
                        <li class="hl-dropdown-item"><checkbox model="vm.table.visibility.status">Status</checkbox></li>
                        <li class="hl-dropdown-item"><checkbox model="vm.table.visibility.priority">Priority</checkbox></li>
                        <li class="hl-dropdown-item"><checkbox model="vm.table.visibility.created">Created</checkbox></li>
                        <li class="hl-dropdown-item"><checkbox model="vm.table.visibility.expires">Expires</checkbox></li>
                        <li class="hl-dropdown-item"><checkbox model="vm.table.visibility.assignedTo">Assigned to</checkbox></li>
                        <li class="hl-dropdown-item"><checkbox model="vm.table.visibility.createdBy">Created by</checkbox></li>
                        <li class="hl-dropdown-item"><checkbox model="vm.table.visibility.tags">Tags</checkbox></li>
                    </ul>
                </li>
            </ul>

            <ul class="hl-button-group">
                <li class="hl-button-group-btn">
                    <a class="hl-button-group-btn-link" href="javascript:;" data-toggle="dropdown">
                        <i class="fa fa-filter"></i>
                        <span class="hide-on-tablet">
                            <span ng-if="vm.selectedFilters.length >= 2">
                                {{ vm.selectedFilters.length }} filters active
                            </span>
                            <span ng-if="vm.selectedFilters.length < 2" ng-repeat="filter in vm.selectedFilters">
                                {{ filter.name }}
                            </span>
                            <span ng-if="!vm.selectedFilters.length">Filters</span>
                        </span>
                        <i class="margin-left-5 small-icon lilicon hl-toggle-down-icon"></i>
                    </a>

                    <span class="hl-button-group-btn-clear" ng-click="vm.clearFilters(false)" ng-show="vm.displayFilterClear">
                        <i class="fa fa-remove"></i>
                    </span>

                    <ul class="hl-dropdown js-hold-on-click">
                        <li class="hl-dropdown-item" ng-repeat="filter in vm.filterList">
                            <checkbox model="filter.selected">{{ filter.name }}</checkbox>
                        </li>
                    </ul>
                </li>
            </ul>


            <list-filter filter-label="'Case types'" view-model="vm"></list-filter>
        </div>

        <div class="widget-filters">
            <due-date-filter filter-store="vm.table.dueDateFilter" type="'case'" class="due-date-filter"></due-date-filter>
            <users-filter users-store="vm.table.usersFilter" storage-name="caseUsersFilter" allow-empty="true" class="user-filter"></users-filter>
        </div>
        <div class="widget-tools">
            <form class="widget-search">
                <div class="hl-search-field-container">
                    <input type="text" class="hl-search-field" ng-model="vm.table.searchQuery" ng-model-options="{debounce: 300}" placeholder="Search">
                    <button type="button" class="hl-search-btn" ng-click="vm.setSearchQuery('')" ng-disabled="!vm.table.searchQuery"></button>
                </div>
            </form>
        </div>
    </div>

    <div class="widget-body">
        <div ng-if="vm.showEmptyState" class="empty-state-container">
            <div class="empty-state-overlay"></div>
            <div class="empty-state-description">
                <h3>Progressional overview of what’s going on</h3>

                <p>Here you’ll find what needs to be done. Keep track of your tasks.</p>

                <p>Start right now and add a <a class="hl-primary-btn" ui-sref="base.cases.create" role="button" onclick="ga('send', 'event', 'Case', 'Open', 'Case list empty state');"><i class="fa fa-plus"></i> Case</a></p>
            </div>
        </div>
        <table class="hl-table">
            <thead class="flip-content">
                <th class="hl-table-column" ng-show="vm.table.visibility.caseId">No.</th>
                <th class="hl-table-column" ng-show="vm.table.visibility.subject">Subject</th>
                <th class="hl-table-column" ng-show="vm.table.visibility.client">Client</th>
                <th class="hl-table-column" ng-show="vm.table.visibility.type" sort-column="type.name" table="vm.table">Type</th>
                <th class="hl-table-column" ng-show="vm.table.visibility.status" sort-column="status.name" table="vm.table">Status</th>
                <th class="hl-table-column" ng-show="vm.table.visibility.priority" sort-column="priority" table="vm.table">Priority</th>
                <th class="hl-table-column" ng-show="vm.table.visibility.created" sort-column="created" table="vm.table">Created</th>
                <th class="hl-table-column" ng-show="vm.table.visibility.expires" sort-column="expires" table="vm.table">Expires</th>
                <th class="hl-table-column" ng-show="vm.table.visibility.assignedTo" sort-column="assigned_to.full_name" table="vm.table">Assigned to</th>
                <th class="hl-table-column" ng-show="vm.table.visibility.createdBy" sort-column="created_by.full_name" table="vm.table">Created by</th>
                <th class="hl-table-column" ng-show="vm.table.visibility.tags">Tags</th>
                <th class="hl-table-column" style="width: 60px;">Actions</th>
            </thead>
            <tbody ng-class="vm.showEmptyState ? 'empty-state-space' : ''">
                <tr ng-repeat="case in vm.table.items">
                    <td class="hl-table-column" ng-show="vm.table.visibility.caseId">
                        {{ ::case.id }}
                    </td>
                    <td class="hl-table-column" ng-show="vm.table.visibility.subject">
                        <strong ng-if="::case.is_archived">(a)</strong>
                        <a ui-sref="base.cases.detail({ id: case.id })" title="{{ ::case.subject }}">{{ ::case.subject }}</a>
                    </td>
                    <td class="hl-table-column" ng-show="vm.table.visibility.client">
                        <a ui-sref="base.contacts.detail({ id: case.contact.id })" ng-if="::case.contact">{{ ::case.contact.full_name }}</a>
                        <span ng-if="case.contact && case.account"> at </span>
                        <a ui-sref="base.accounts.detail({ id: case.account.id })">{{ ::case.account.name }}</a>
                    </td>
                    <td class="hl-table-column" ng-show="vm.table.visibility.type">
                        {{ ::case.type.name }}
                    </td>
                    <td class="hl-table-column" ng-show="vm.table.visibility.status">
                        {{ ::case.status.name }}
                    </td>
                    <td class="hl-table-column" ng-show="vm.table.visibility.priority" class="priority-cell">
                        <editable-select field="priority" view-model="vm" type="Case" object="case" choice-field="true" select-type="icon_select"
                                     select-options="{field: 'casePriorities', 'classPrefix': 'lilicon hl-prio-icon-', 'classValue': 'name'}">
                            <i class="lilicon hl-prio-icon-{{ case.priority_display | lowercase }}" tooltip-placement="left" uib-tooltip="{{ case.priority_display }}"></i>
                        </editable-select>
                    </td>
                    <td class="hl-table-column" ng-show="vm.table.visibility.created">
                        <date date="case.created"></date>
                    </td>
                    <td class="hl-table-column" ng-show="vm.table.visibility.expires" title="{{ case.expires | date:'dd MMMM y HH:mm' }}">
                        <postpone type="'Case'" object="case" date-field="'expires'"></postpone>
                    </td>
                    <td class="hl-table-column" ng-show="vm.table.visibility.assignedTo">
                        <assign-to type="Case" object="case"></assign-to>
                    </td>
                    <td class="hl-table-column" ng-show="vm.table.visibility.createdBy">
                        {{ ::case.created_by.full_name }}
                    </td>
                    <td class="hl-table-column" ng-show="vm.table.visibility.tags">
                        <span ng-repeat="tag in case.tags">
                            <a href="javascript:void(0)" ng-click="vm.setSearchQuery(tag.name)">{{ ::tag.name }}</a>
                            <br>
                        </span>
                    </td>
                    <td class="hl-table-column">
                        <a ui-sref="base.cases.detail.edit({ id: case.id })" class="hl-primary-btn-smll" title="Edit">
                            <i class="lilicon hl-edit-icon"></i>
                        </a>
                    </td>
                </tr>
            </tbody>
            <tfoot>
                <tr>
                    <td class="hl-table-column" colspan="12"><hl-pagination values="vm.table"></hl-pagination></td>
                </tr>
            </tfoot>
        </table>
    </div>
</div>
